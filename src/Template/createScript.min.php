(function(){var e=function(l,k){return Object.prototype.toString.call(l)===("[object "+k+"]")};var g=function(k){k.forEach(function(n){var m=n.type?(""+n.type).toLocaleLowerCase():"",l=e(k.children,"Array")?k.children:[];if((m==="cascader"||m==="tree")&&n.props){if(n.props.data&&e(n.props.data,"String")&&n.props.data.indexOf("js.")===0){n.props.data=window[n.props.data.substr(3)]}else{if(n.props.options&&e(n.props.options,"String")&&n.props.options.indexOf("js.")===0){n.props.options=window[n.props.options.substr(3)]}}}if(l.length){g(l)}});return k};var i=function(k,l,m,n){$.ajax({url:k,type:(""+l).toLocaleUpperCase(),dataType:"json",headers:c,contentType:j,data:m,success:function(o){n(1,o)},error:function(){n(0)}})};var h=g(<?=$form->parseFormRule()?>),c=<?=$form->parseHeaders()?>,d=<?=$form->parseFormConfig()?>,j="<?=$form->getFormContentType()?>",f="<?=$form->getAction()?>",a="<?=$form->getMethod()?>",b=new Vue();if(!b.$Message && b.$message){Vue.prototype.$Message = b.$message}return function(l,m){if(l){d.el=l}d.onSubmit=function(n){k.btn.loading(true);i(f,a,n,function(o,p){if(m){return m(o,p,k)}if(o&&p.code===200){k.submitBtnProps({loading:false,disabled:true});b.$Message.success(p.msg||"表单提交成功")}else{k.btn.loading(false);b.$Message.error("表单提交失败")}})};d.global={upload:{props:{onExceededSize:function(n){b.$Message.error(n.name+"超出指定大小限制")},onFormatError:function(){b.$Message.error(file.name+"格式验证失败")},onError:function(n){b.$Message.error(file.name+"上传失败,("+n+")")},onSuccess:function(o,n){if(o.code===200){n.url=o.data.filePath}else{b.$Message.error(o.msg)}}}}};var k=formCreate.create(h,d);return k}})();